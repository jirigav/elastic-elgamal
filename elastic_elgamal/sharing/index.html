<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Feldman’s verifiable secret sharing (VSS) for ElGamal encryption."><meta name="keywords" content="rust, rustlang, rust-lang, sharing"><title>elastic_elgamal::sharing - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../SourceSerif4-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../FiraSans-Regular.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../FiraSans-Medium.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../SourceCodePro-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../SourceSerif4-Bold.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../SourceCodePro-Semibold.ttf.woff2"><link rel="stylesheet" type="text/css" href="../../normalize.css"><link rel="stylesheet" type="text/css" href="../../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../../ayu.css" disabled><link rel="stylesheet" type="text/css" href="../../dark.css" disabled><link rel="stylesheet" type="text/css" href="../../light.css" id="themeStyle"><script id="default-settings" ></script><script src="../../storage.js"></script><script src="../../crates.js"></script><script defer src="../../main.js"></script>
    <noscript><link rel="stylesheet" href="../../noscript.css"></noscript><link rel="alternate icon" type="image/png" href="../../favicon-16x16.png"><link rel="alternate icon" type="image/png" href="../../favicon-32x32.png"><link rel="icon" type="image/svg+xml" href="../../favicon.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="sidebar-logo" href="../../elastic_elgamal/index.html"><div class="logo-container"><img class="rust-logo" src="../../rust-logo.svg" alt="logo"></div>
        </a><h2 class="location"></h2>
    </nav>
    <nav class="sidebar"><a class="sidebar-logo" href="../../elastic_elgamal/index.html"><div class="logo-container"><img class="rust-logo" src="../../rust-logo.svg" alt="logo"></div>
        </a><h2 class="location"><a href="#">Module sharing</a></h2><div class="sidebar-elems"><section><div class="block"><ul><li><a href="#structs">Structs</a></li><li><a href="#enums">Enums</a></li></ul></div></section><div id="sidebar-vars" data-name="sharing" data-ty="mod" data-relpath="./"></div><script defer src="./sidebar-items.js"></script></div></nav><main><div class="width-limiter"><div class="sub-container"><a class="sub-logo-container" href="../../elastic_elgamal/index.html"><img class="rust-logo" src="../../rust-logo.svg" alt="logo"></a><nav class="sub"><div class="theme-picker hidden"><button id="theme-picker" aria-label="Pick another theme!" aria-haspopup="menu" title="themes"><img width="22" height="22" alt="Pick another theme!" src="../../brush.svg"></button><div id="theme-choices" role="menu"></div></div><form class="search-form"><div class="search-container"><span></span><input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><button type="button" id="help-button" title="help">?</button><a id="settings-menu" href="../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../wheel.svg"></a></div></form></nav></div><section id="main-content" class="content"><div class="main-heading">
    <h1 class="fqn"><span class="in-band">Module <a href="../index.html">elastic_elgamal</a>::<wbr><a class="mod" href="#">sharing</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../../clipboard.svg" width="19" height="18" alt="Copy item path"></button></span></h1><span class="out-of-band"><a class="srclink" href="../../src/elastic_elgamal/sharing/mod.rs.html#1-329">source</a> · <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span></div><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p><a href="https://www.cs.umd.edu/%7Egasarch/TOPICS/secretsharing/feldmanVSS.pdf">Feldman’s verifiable secret sharing</a> (VSS) for ElGamal encryption.</p>
<p>Feldman’s VSS is an extension of <a href="https://en.wikipedia.org/wiki/Shamir%27s_Secret_Sharing">Shamir’s secret sharing</a> that provides a degree
of verifiability for the scheme participants and the public. As with other VSS schemes,
the goal is to securely distribute a secret among <code>n</code> participants so that the secret can
be recombined by any <code>t</code> (but not less) of these participants. Unlike distributed key
generation (DKG), VSS assumes a central authority (a <em>dealer</em>) generating the secret
and distributing its shares among participants.</p>
<h2 id="construction"><a href="#construction">Construction</a></h2>
<p><strong>Inputs:</strong></p>
<ul>
<li>Total number of participants <code>n</code></li>
<li>Minimum number of participants necessary to restore secret <code>t</code></li>
<li>Prime-order group with discrete log assumption with generator <code>G</code></li>
</ul>
<p><strong>Assumptions:</strong></p>
<ul>
<li>There is a secure broadcast among participants, which acts as a single source of truth
(e.g., a blockchain). The broadcast is synchronous w.r.t. the protocol steps (in practice,
this means that protocol steps take sufficiently long amount of time).</li>
<li>Secure synchronous P2P channels can be established between the dealer and participants.</li>
<li>The adversary is static (corrupts parties before protocol instantiation) and can corrupt
less than a half of participants (including the dealer).</li>
</ul>
<p>Feldman’s VSS proceeds as follows:</p>
<ol>
<li>The dealer generates a secret <code>x</code> (a scalar in a group with discrete log assumption).
Along with this scalar, the dealer generates <code>t</code> other scalars that are also kept secret.
These scalars form a secret polynomial of degree <code>t</code>: <code>P(z) = x + x_1 * z + x_2 * z^2 + …</code>.</li>
<li>The dealer publishes coefficients <code>[x]G</code>, <code>[x_1]G</code>, …, <code>[x_t]G</code> of the <em>public polynomial</em>
corresponding to <code>P</code>: <code>Q(z) = [x]G + [z][x_1]G + [z^2][x_2]G + …</code>. Here, <code>[x]G</code> is the shared
public key, and values <code>Q(i)</code> at <code>i = 1..=n</code> are public key shares of participants.</li>
<li>The dealer distributes secret key shares <code>s_i = P(i)</code> among participants <code>i = 1..=n</code>
via secure P2P channels. Each participant can verify share validity by calculating
<code>[s_i]G ?= Q(i)</code>.</li>
</ol>
<p>If a participant receives an incorrect secret share, the participant broadcasts a <em>complaint</em>
against the dealer. The dealer responds by broadcasting the participant’s share. Either the
share is correct (in which case the complaining participant is at fault), or it is not
(in which case the dealer is at fault).</p>
<p>To improve auditability, the implemented version of VSS provides zero-knowledge proofs
of possession both for the dealer and participants. The dealer must broadcast the public
polynomial together with the proof; participants should broadcast proof of knowledge of
a secret share once they receive the share from the dealer.</p>
<h2 id="on-distributed-key-generation"><a href="#on-distributed-key-generation">On distributed key generation</a></h2>
<p>While DKG allows for a fully decentralized setup unlike VSS, it is difficult to get right.
For example, <a href="https://link.springer.com/content/pdf/10.1007/3-540-48910-X_21.pdf">Gennaro et al.</a> show that DKG via parallel Feldman’s VSS instances where
each participant is a dealer in one of the instances is not secure; the adversary
can bias distribution of the shared public key. Hence, DKG is not (yet?) implemented
in this crate.</p>
<h2 id="examples"><a href="#examples">Examples</a></h2>
<p>Threshold encryption scheme requiring 2 of 3 participants.</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">let</span> <span class="kw-2">mut</span> <span class="ident">rng</span> <span class="op">=</span> <span class="ident">thread_rng</span>();
<span class="kw">let</span> <span class="ident">params</span> <span class="op">=</span> <span class="ident">Params::new</span>(<span class="number">3</span>, <span class="number">2</span>);

<span class="comment">// Initialize the dealer.</span>
<span class="kw">let</span> <span class="ident">dealer</span> <span class="op">=</span> <span class="ident">Dealer</span>::<span class="op">&lt;</span><span class="ident">Ristretto</span><span class="op">&gt;</span><span class="ident">::new</span>(<span class="ident">params</span>, <span class="kw-2">&amp;mut</span> <span class="ident">rng</span>);
<span class="kw">let</span> (<span class="ident">public_poly</span>, <span class="ident">poly_proof</span>) <span class="op">=</span> <span class="ident">dealer</span>.<span class="ident">public_info</span>();
<span class="kw">let</span> <span class="ident">key_set</span> <span class="op">=</span> <span class="ident">PublicKeySet::new</span>(<span class="ident">params</span>, <span class="ident">public_poly</span>, <span class="ident">poly_proof</span>)<span class="question-mark">?</span>;

<span class="comment">// Initialize participants based on secret shares provided by the dealer.</span>
<span class="kw">let</span> <span class="ident">participants</span> <span class="op">=</span> (<span class="number">0</span>..<span class="number">3</span>)
    .<span class="ident">map</span>(<span class="op">|</span><span class="ident">i</span><span class="op">|</span> <span class="ident">ActiveParticipant::new</span>(
        <span class="ident">key_set</span>.<span class="ident">clone</span>(),
        <span class="ident">i</span>,
        <span class="ident">dealer</span>.<span class="ident">secret_share_for_participant</span>(<span class="ident">i</span>),
    ))
    .<span class="ident">collect</span>::<span class="op">&lt;</span><span class="prelude-ty">Result</span><span class="op">&lt;</span><span class="ident">Vec</span><span class="op">&lt;</span><span class="kw">_</span><span class="op">&gt;</span>, <span class="kw">_</span><span class="op">&gt;</span><span class="op">&gt;</span>()<span class="question-mark">?</span>;

<span class="comment">// At last, participants can decrypt messages!</span>
<span class="kw">let</span> <span class="ident">encrypted_value</span> <span class="op">=</span> <span class="number">5_u64</span>;
<span class="kw">let</span> <span class="ident">enc</span> <span class="op">=</span> <span class="ident">key_set</span>.<span class="ident">shared_key</span>().<span class="ident">encrypt</span>(<span class="ident">encrypted_value</span>, <span class="kw-2">&amp;mut</span> <span class="ident">rng</span>);
<span class="kw">let</span> <span class="ident">shares_with_proofs</span> <span class="op">=</span> <span class="ident">participants</span>
    .<span class="ident">iter</span>()
    .<span class="ident">map</span>(<span class="op">|</span><span class="ident">p</span><span class="op">|</span> <span class="ident">p</span>.<span class="ident">decrypt_share</span>(<span class="ident">enc</span>, <span class="kw-2">&amp;mut</span> <span class="ident">rng</span>))
    .<span class="ident">take</span>(<span class="number">2</span>); <span class="comment">// emulate the 3rd participant dropping off</span>

<span class="comment">// Emulate share transfer via untrusted network.</span>
<span class="kw">let</span> <span class="ident">dec_shares</span> <span class="op">=</span> <span class="ident">shares_with_proofs</span>
    .<span class="ident">enumerate</span>()
    .<span class="ident">map</span>(<span class="op">|</span>(<span class="ident">i</span>, (<span class="ident">share</span>, <span class="ident">proof</span>))<span class="op">|</span> {
        <span class="kw">let</span> <span class="ident">share</span> <span class="op">=</span> <span class="ident">CandidateDecryption::from_bytes</span>(<span class="kw-2">&amp;</span><span class="ident">share</span>.<span class="ident">to_bytes</span>()).<span class="ident">unwrap</span>();
        <span class="ident">key_set</span>.<span class="ident">verify_share</span>(<span class="ident">share</span>, <span class="ident">enc</span>, <span class="ident">i</span>, <span class="kw-2">&amp;</span><span class="ident">proof</span>).<span class="ident">unwrap</span>()
    });

<span class="comment">// Combine decryption shares.</span>
<span class="kw">let</span> <span class="ident">combined</span> <span class="op">=</span> <span class="ident">params</span>.<span class="ident">combine_shares</span>(<span class="ident">dec_shares</span>.<span class="ident">enumerate</span>()).<span class="ident">unwrap</span>();
<span class="comment">// Use a lookup table to decrypt back to scalar.</span>
<span class="kw">let</span> <span class="ident">lookup_table</span> <span class="op">=</span> <span class="ident">DiscreteLogTable</span>::<span class="op">&lt;</span><span class="ident">Ristretto</span><span class="op">&gt;</span><span class="ident">::new</span>(<span class="number">0</span>..<span class="number">10</span>);
<span class="kw">let</span> <span class="ident">dec</span> <span class="op">=</span> <span class="ident">combined</span>.<span class="ident">decrypt</span>(<span class="ident">enc</span>, <span class="kw-2">&amp;</span><span class="ident">lookup_table</span>);
<span class="macro">assert_eq!</span>(<span class="ident">dec</span>, <span class="prelude-val">Some</span>(<span class="ident">encrypted_value</span>));</code></pre></div>
</div></details><h2 id="structs" class="small-section-header"><a href="#structs">Structs</a></h2>
<div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.ActiveParticipant.html" title="elastic_elgamal::sharing::ActiveParticipant struct">ActiveParticipant</a></div><div class="item-right docblock-short"><p>Personalized state of a participant of a threshold ElGamal encryption scheme
once the participant receives the secret share from the <a href="struct.Dealer.html" title="Dealer"><code>Dealer</code></a>.
At this point, the participant can produce <a href="../struct.VerifiableDecryption.html" title="VerifiableDecryption"><code>VerifiableDecryption</code></a>s.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Dealer.html" title="elastic_elgamal::sharing::Dealer struct">Dealer</a></div><div class="item-right docblock-short"><p>Dealer in a <a href="https://www.cs.umd.edu/%7Egasarch/TOPICS/secretsharing/feldmanVSS.pdf">Feldman verifiable secret sharing</a> scheme.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Params.html" title="elastic_elgamal::sharing::Params struct">Params</a></div><div class="item-right docblock-short"><p>Parameters of a threshold ElGamal encryption scheme.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.PublicKeySet.html" title="elastic_elgamal::sharing::PublicKeySet struct">PublicKeySet</a></div><div class="item-right docblock-short"><p>Full public information about the participants of a threshold ElGamal encryption scheme
after all participants’ commitments are collected.</p>
</div></div></div><h2 id="enums" class="small-section-header"><a href="#enums">Enums</a></h2>
<div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.Error.html" title="elastic_elgamal::sharing::Error enum">Error</a></div><div class="item-right docblock-short"><p>Errors that can occur during the secret sharing protocol.</p>
</div></div></div></section></div></main><div id="rustdoc-vars" data-root-path="../../" data-current-crate="elastic_elgamal" data-themes="ayu,dark,light" data-resource-suffix="" data-rustdoc-version="1.62.0 (a8314ef7d 2022-06-27)" ></div>
</body></html>